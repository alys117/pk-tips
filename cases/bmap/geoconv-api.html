<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="http://bj.bcebos.com/v1/mapopen/api-demos/js/mapStyle.js"></script>
  <script src="./custom_map_config.js"></script>
  <script src="//api.map.baidu.com/api?type=webgl&v=1.0&ak=eW6pGAAUT8KnuTDv6oxOoyVk0wBsGYHy"></script>
  <link href="//mapopen.cdn.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.css" rel="stylesheet">
  <script type="text/javascript"
    src="//mapopen.bj.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.js"></script>
  <!--加载鼠标绘制工具-->
  <!-- <script type="text/javascript"
    src="http://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.js"></script>
  <link rel="stylesheet" href="http://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.css" /> -->
  <title>DrawingManager</title>
  <style>
    * {
      padding: 0;
      margin: 0;
    }

    /* 隐藏百度地图logo */
    .anchorBL {
      /* display: none; */
    }

    .BMapLib_Drawing.BMap_noprint.anchorBL {
      display: block;
    }
  </style>
</head>

<body>
  <div id="allmap" style="overflow:hidden;zoom:1;position:relative; width: 100vw;height: 100vh;">
    <div id="map" style="height:100%;-webkit-transition: all 0.5s ease-in-out;transition: all 0.5s ease-in-out;"></div>
  </div>
  <style type="text/css">
    body,
    html,
    #container {
      width: 100%;
      height: 100%;
      overflow: hidden;
      margin: 0;
      font-family: "微软雅黑";
    }

    ul li {
      list-style: none;
    }

    .info {
      z-index: 999;
      width: auto;
      min-width: 22rem;
      padding: .75rem 1.25rem;
      margin-left: 1.25rem;
      position: fixed;
      top: 1rem;
      background-color: #fff;
      border-radius: .25rem;
      font-size: 14px;
      color: #666;
      box-shadow: 0 2px 6px 0 rgba(27, 142, 236, 0.5);
    }

    .drawing-panel {
      z-index: 999;
      position: fixed;
      bottom: 3.5rem;
      margin-left: 2.5rem;
      padding-left: 0;
      border-radius: .25rem;
      height: 47px;
      box-shadow: 0 2px 6px 0 rgba(27, 142, 236, 0.5);
    }

    .bmap-btn {
      border-right: 1px solid #d2d2d2;
      float: left;
      width: 64px;
      height: 100%;
      background-image: url(//api.map.baidu.com/library/DrawingManager/1.4/src/bg_drawing_tool.png);
      cursor: pointer;
    }

    .drawing-panel .bmap-marker {
      background-position: -65px 0;
    }

    .drawing-panel .bmap-polyline {
      background-position: -195px 0;
    }

    .drawing-panel .bmap-rectangle {
      background-position: -325px 0;
    }

    .drawing-panel .bmap-polygon {
      background-position: -260px 0;
    }

    .drawing-panel .bmap-circle {
      background-position: -130px 0;
    }
  </style>
  </head>

  <body>
    <div class="info">该示例实现基于JSAPI GL版的开源工具库，详情可查看https://github.com/huiyan-fe/BMapGLLib</div>
    <ul class="drawing-panel">
      <li class="bmap-btn bmap-marker" id="marker" onclick="draw(this)"></li>
      <li class="bmap-btn bmap-polyline" id="polyline" onclick="draw(this)"></li>
      <li class="bmap-btn bmap-rectangle" id="rectangle" onclick="draw(this)"></li>
      <li class="bmap-btn bmap-polygon" id="polygon" onclick="draw(this)"></li>
      <li class="bmap-btn bmap-circle" id="circle" onclick="draw(this)"></li>
    </ul>
  </body>

  <script>
    // 百度地图API功能
    var map = new BMapGL.Map('map');
    var poi = new BMapGL.Point(116.307852, 40.057031);
    map.centerAndZoom(poi, 16);//设置中心点坐标和地图级别
    map.enableScrollWheelZoom(); //启用鼠标滚动对地图放大缩

    //添加gps marker和label
    var markergg = new BMapGL.Marker(poi);
    map.addOverlay(markergg); //添加GPS marker
    var labelgg = new BMapGL.Label("未转换的GPS坐标（错误）", { offset: new BMapGL.Size(10, -10) });
    markergg.setLabel(labelgg); //添加GPS label

    //坐标转换完之后的回调函数
    var translateCallback = function (data) {
      console.log(poi,data);
      if (data.status === 0) {
        var marker = new BMapGL.Marker(data.points[0]);
        map.addOverlay(marker);
        var label = new BMapGL.Label("转换后的百度坐标（正确）", { offset: new BMapGL.Size(10, -10) });
        marker.setLabel(label); //添加百度label
        map.setCenter(data.points[0]);
      }
    }


    var convertor = new BMapGL.Convertor();
    var pointArr = [];
    pointArr.push(poi);
    convertor.translate(pointArr, COORDINATES_WGS84, COORDINATES_BD09, translateCallback)
  </script>

</html>